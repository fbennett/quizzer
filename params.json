{"name":"Quizzer","tagline":"A lightweight writing lab quiz engine for node.js","body":"## Overview\r\n\r\nQuizzer is a tool for writing instruction, tailored to the needs of\r\nsecond language learners and students encountering the demands of\r\nformal writing for the first time. The system and method are designed\r\nto make efficient use of staff time, and to motivate students by\r\napplying a non-punitive 'fail early, fail often' approach to the\r\nwriting process. The system is simple to set up (see below).\r\n\r\nIn or Academic Writing program in the Nagoya University Faculty of\r\nLaw, Quizzer supports the following workflow:\r\n\r\n1. Students submit a 400-word essay once each week on an arbitrary\r\n   topic.\r\n2. The instructor selects one poorly-written sentence from each\r\n   essay, and composes a multiple-choice question consisting of the\r\n   student's own sentence, two alternatives that also contain errors,\r\n   and a corrected version. *The essays themselves are not assessed.*\r\n3. After constructing one question from each submitted essay, students\r\n   are sent personalized links to the resulting quiz.\r\n4. Students submit their responses, which are recorded on the Quizzer\r\n   server. Student receive feedback immediately feedback on their\r\n   incorrect responses.\r\n5. Class commenters (TAs, instructors, and other experienced writers)\r\n   post short explanations of why the wrong answers were wrong.\r\n6. When students revisit their quiz links, they will find\r\n   both the comments, and a list of classmates who gave the correct answer\r\n   to the questions that they missed.\r\n7. Students are given an assessed, paper-based, multiple-choice\r\n   supplementary mid-term and final exam, consisting entirely of\r\n   questions from the quizzes.\r\n\r\nQuiz distribtion, commenting, exam composition, and marking are all\r\nmanaged by Quizzer. Paper tests are randomized as a hedge against\r\ncheating, and marked with a barcode reader for quick assessment.\r\n\r\nThe original motivation for this work was an unpleasant encounter with\r\nthe products of a commercial vendor. Quizzes are *simple* things. They\r\nshould be easy to customise, and deploying a quiz to a given group of\r\nstudents should not require weeks of effort, large volumes of email,\r\nnumerous meetings and progress reports, or extensive trial-and-error\r\nexploration of a byzantine menu system. Software is supposed to save\r\ntime, not the other way around. It should just do its job, so that we\r\ncan get on with our own.\r\n\r\nThe initial inspiration for this particular attempt to do better was a\r\nsimple [code\r\nsample](http://chetan0389.blogspot.jp/2013/06/quiz-using-htmlcss-jquery-xml-javascript.html)\r\nposted by Chetan Jain. The code has been refactored and extended considerably\r\nfor this project, but I gratefully acknowledge the starting\r\npoint for this frolic.\r\n\r\n## Basic Installation\r\n\r\nInstall quizzer from the `npm` repository:\r\n\r\n    npm install quizzer\r\n\r\nIn addition to the dependencies pulled in by `npm`, Quizzer needs to\r\nhave access to the external programs `pandoc` and `pdflatex`. While\r\n`pdflatex` should be available as package installs on your operating\r\nsystem (probably as part of the `texlive` package), `pandoc` is a\r\ndifferent matter.\r\n\r\nQuizzer uses a simple JavaScript module to convert `markdown` text to\r\nHTML, supplemented by `MathJax` for mathematical formulae. When generating\r\nexamination papers, the `markdown` + `MathJax` markup must be converted to\r\n`LaTeX`, and `pandoc` is used for that purpose. For things to work correctly,\r\nmathematical formulae must be left intact during the conversion. An extension\r\nto `pandoc` (`tex_math_dollars`) exists for this exact purpose, but unfortunately\r\nit is available only in `pandoc` version 1.10 and above.\r\n\r\nDepending on your system, installing `pandoc` 1.10+ may be something\r\nof a chore at this point in time. In our own environment, getting it\r\nin place on an aging virtual server running CentOS 6 required a\r\nscratch build of both the Glasgow Haskell Compiler and the Haskell Platform.\r\nEverything worked swimmingly after that was done, but the compile process\r\ntook several hours, and needed to be nudged forward repeatedly.\r\n\r\nIf `pandoc` 1.10 is not an option, and you don't need maths rendering, you\r\ncan use an earlier pandoc by editing the following file:\r\n\r\n   ./api/admin/quiz/downloadexam/matchExec.js\r\n\r\nJust change `html+tex_math_dollars` to simply `html`, and you should be good.\r\n\r\nApart from this transitional speed bump, installation is simple. Run\r\nthe server by saving the following code to a file (such as\r\n`quizServer.js`, say):\r\n\r\n    var qz = require('quizzer');\r\n    qz.run();\r\n\r\nRun the script from command line like this:\r\n\r\n    node ./quizServer.js\r\n\r\nThe script will whinge on first run, asking for some essential\r\ndetails:\r\n\r\n    usage: quizServer.js [-h] [-v] [-H PROXY_HOSTNAME] [-p REAL_PORT]\r\n                         [-e EMAIL_ACCOUNT] [-s SMTP_HOST]\r\n                         \r\n    \r\n    Quizzer, a quiz server\r\n    \r\n    Optional arguments:\r\n      -h, --help            Show this help message and exit.\r\n      -v, --version         Show program's version number and exit.\r\n      -H PROXY_HOSTNAME, --proxy-hostname PROXY_HOSTNAME\r\n                            Host name for external access\r\n      -p REAL_PORT, --real-port REAL_PORT\r\n                            Port on which to listen for local connections\r\n      -e EMAIL_ACCOUNT, --email-account EMAIL_ACCOUNT\r\n                            Full username of email account (e.g. useme@gmail.com)\r\n      -s SMTP_HOST, --smtp-host SMTP_HOST\r\n                            SMTP host name (e.g. smtp.gmail.com)\r\n      ERROR: must set option smtp_host\r\n      ERROR: must set option proxy_hostname\r\n      ERROR: must set option email_account\r\n\r\nA GMail account can be used as `EMAIL_ACCOUNT`, with `smtp.gmail.com` as `SMTP_HOST`.\r\n`REAL_PORT` will default to `3498`, but can be set to other values for multiple\r\nserver instances. For initial testing, `PROXY_HOSTNAME` should be set to `127.0.0.1`\r\nor `localhost`. Running again will yield this:\r\n\r\n    ERROR: file mypwd.txt not found: Error: ENOENT, no such file or directory './mypwd.txt'\r\n\r\nSave the email account password to disk in a file `mypwd.txt` (only the user running\r\nQuizzer should have access permissions on the file, obviously). This will get the server\r\nrunning:\r\n\r\n    Wrote config parameters to quizzer-3498.cfg\r\n    Quizzer can now be run with the single option: -p 3498\r\n    Admin URL: http://localhost:3498/?admin=fyvg19vx\r\n    Adding admin role\r\n    Loaded class membership keys\r\n    Done. Ready to shake, rattle and roll!\r\n\r\nConnect to the listed URL with a browser, and you're ready to go.  The\r\ndatabase and configuration files are created in the directory from\r\nwhich the script is run, named after the port number. The server can\r\nbe shut down with `CTRL-c` (`SIGINT`), and as the startup message\r\nsays, it can be restarted with the single option `-p <REAL_PORT>`\r\n(Note that the `admin` key is automatically generated, and will differ\r\nfrom that shown in the example above.)\r\n\r\n## Running Quizzer behind a Proxy\r\n\r\nWhen `PROXY_HOSTNAME` is set to a fully qualified domain name\r\n(e.g. `myschool.edu`), it will assume that it is being run behind a\r\nreverse proxy, and adjust URLs accordingly. Quizzer itself has only\r\nthe thinnest concept of security, and should be run behind a proxy in\r\nproduction (and preferably over SSL). Access to the administrator\r\ndisplay depends on a key set in the URL of a GET request. Rewrite\r\nrules on the front-end web server should be used to assure that\r\nattempts to set the key directly are rerouted through a\r\npassword-protected URL.\r\n\r\nIf `lighttpd` is used as the front-end server, and Quizzer is run from\r\na directory `quizzer` to which the server has access, configuration\r\nsettings like the following should do the trick:\r\n\r\n    url.rewrite = (\r\n      \"^(?!/quizzer)(.*)\\?admin=[^&]+(?:&(.*))*\" => \"/quizzer/admin.html$1?$2\",\r\n      \"^(?!/quizzer)(.*)&admin=[^&]+(?:&(.*))*\" => \"/quizzer/admin.html$1&$2\",\r\n      \"^/quizzer/admin.html$\" => \"/quizzer/admin.html?admin=fyvg19vx\",\r\n      \"^/quizzer/admin.html\\?(.*)$\" => \"/quizzer/admin.html?admin=fyvg19vx&$1\"\r\n    )\r\n    \r\n    $HTTP[\"host\"] == \"faculty.of.things.edu\" {\r\n      proxy.server = ( \"/quizzer\" => ( ( \"host\" => \"127.0.0.1\", \"port\" => 3498 ) ) )\r\n    }\r\n    \r\n    auth.backend = \"htdigest\"\r\n    auth.backend.htdigest.userfile = \"/etc/lighttpd/lighttpd.user\"\r\n    \r\n    auth.require = ( \"/quizzer/admin.html\" =>\r\n      (\r\n        \"method\" => \"basic\",\r\n        \"realm\" => \"Quiz Admin\",\r\n        \"require\" => \"user=quizmaster\"\r\n      )\r\n    )\r\n    \r\n## Adding Commenters\r\n\r\nQuizzer data is held in an `sqlite3` database, located in the directory\r\nfrom which the script is run, and named after the port number under\r\nwhich the instance is running. \r\n\r\ncommenters are held in the `admin` table of the Quizzer database.\r\nThere is no web interface to this table: add commenters by inserting\r\nthem directly, using the `sqlite3` access tool, like so:\r\n\r\n    sqlite3> INSERT INTO admin VALUES (NULL, 'jeff', 'ahTh3nie', 2, 0);\r\n\r\nThe `NULL` value in the first column is for the automatically-assigned\r\nnumeric ID of the database row. The second column is the screen\r\nname of the commenter, which must be unique. The third column is the\r\naccess key that will be included in the personal URL of the commenter,\r\nand must also be unique. Under Linux, the `pwgen` utility is a handy\r\ntool for creating these. The fourth column is the role of the commenter,\r\nand must be set to `2`. The fifth column is currently unused, but may\r\neventually control the intervals at which scheduled key resets and\r\nreminder mailings occur.\r\n\r\nAfter commenters have been added to the `admin` table, their\r\naccess URLs will be reported in the startup chatter. For example:\r\n\r\n    Reading config from quizzer-3498.cfg\r\n    Admin URL: http://localhost:3498/?admin=fyvg19vx\r\n    Adding admin role\r\n    Adding commenter 'adam' with URL http://localhost:3498/?commenter=En5chaej\r\n    Adding commenter 'bob' with URL http://localhost:3498/?commenter=koosha1D\r\n    Adding commenter 'chris' with URL http://localhost:3498/?commenter=Ro5aise5\r\n    Loaded class membership keys\r\n    Done. Ready to shake, rattle and roll!\r\n\r\nThe commenter links show a list of courses, and course links a list\r\nof quizzes with the number of uncommented mistakes, if any. Clicking on\r\na quiz link opens a list of wrong answers, sorted in descending order\r\nof frequency among quiz-takers, and with already-commented answers\r\npushed to the bottom.\r\n\r\n`Markdown` syntax is recognized in comment text, with a few small\r\nextensions. To set markers in text, enclose a number or letter in\r\ndouble parens:\r\n\r\n    This will render as a circle-A: ((A))\r\n\r\nFor an explanation of why a wrong answer was wrong,\r\nset a single `>` character at the beginning of the line,\r\nfollowed by the pasted text of the wrong answer to be explained:\r\n\r\n    > Many new legislations were passed in 2010.\r\n\r\nMark text targeted for specific comment by wrapping it in\r\ndouble-quotes, opening with a single letter or number:\r\n\r\n    > ((1 Many)) new ((2 legislations)) ((3 were)) passed in 2010.\r\n\r\n    ((2)) is a non-countable noun, and is *never* written\r\n    with an 's'. With a non-countable noun, use 'much', not\r\n    'many' at ((1)), and the singular verb form at ((3)).\r\n\r\nFor a comment that states a pattern, open with two '>' characters:\r\n\r\n    >> I studied *for* two hours.\r\n\r\nFor a comment that states a grammatical rule, open with\r\nthree '>' characters:\r\n\r\n    >>> Never use the word \"nowadays\" in formal writing.\r\n\r\nWhen set at the very beginning of an entry, the explanation,\r\npattern, and rule prefixes trigger a tidy heading in the displayed\r\nentry.\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}